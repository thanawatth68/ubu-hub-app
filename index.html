<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UBU Hub - Stable Version</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Sarabun', sans-serif; }
        .app-container { scrollbar-width: none; -ms-overflow-style: none; }
        .app-container::-webkit-scrollbar { display: none; }
        .page-content { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes animated-gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .has-animated-bg::before {
            content: ''; position: absolute; top: 0; right: 0; bottom: 0; left: 0; z-index: -1;
            background: linear-gradient(270deg, #eef2ff, #e0e7ff, #c7d2fe);
            background-size: 400% 400%; animation: animated-gradient 18s ease infinite;
        }
        .dark .has-animated-bg::before { background: linear-gradient(270deg, #1e293b, #334155, #111827); }
        .dark .bg-white { background-color: #1f2937; }
        .dark .bg-gray-50 { background-color: #111827; }
        .dark .bg-white\/80 { background-color: rgba(31, 41, 55, 0.8); }
        .dark .text-gray-800 { color: #f9fafb; }
        .dark .text-gray-700 { color: #d1d5db; }
        .dark .text-gray-600 { color: #9ca3af; }
        .dark .text-gray-900 { color: #f9fafb; }
        .dark .border-b, .dark .border-t, .dark .divide-y > :not([hidden]) ~ :not([hidden]) { border-color: #374151; }
        .dark .shadow-md { box-shadow: 0 4px 6px -1px rgba(0,0,0,0.4), 0 2px 4px -2px rgba(0,0,0,0.4); }
        .dark input { background-color: #374151; color: #f9fafb; border-color: #4b5563; }
        .dark .filter-button-active { background-color: #4f46e5; color: white; }
        .dark .bg-gray-100 { background-color: #374151;}
    </style>
</head>
<body class="bg-gray-200 flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-sm mx-auto bg-gray-50 dark:bg-gray-900 rounded-3xl shadow-2xl overflow-hidden border-4 border-gray-800 relative has-animated-bg">
        <div class="h-[750px] overflow-y-auto app-container">
            
            <header class="sticky top-0 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm z-20 p-4 flex justify-between items-center border-b">
                <div class="flex items-center space-x-2">
                    <button id="back-button" onclick="goBack()" class="hidden text-gray-600 p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg></button>
                    <div id="header-title"><h1 class="text-xl font-bold text-indigo-700">UBU HUB</h1></div>
                </div>
                <div>
                    <img src="https://placehold.co/40x40/EFEFEF/333333?text=S" class="w-9 h-9 rounded-full cursor-pointer" alt="User Profile" onclick="navigateTo('settings')">
                </div>
            </header>

            <div id="main-content-container" class="relative">
                <!-- Pages will be dynamically inserted here -->
            </div>

            <div class="h-20"></div> 
        </div>

        <nav id="bottom-nav" class="absolute bottom-0 left-0 right-0 w-full max-w-sm mx-auto bg-white border-t rounded-b-3xl z-10">
            <div class="flex justify-around py-2">
                <a id="nav-home" href="javascript:void(0);" onclick="navigateTo('home')" class="nav-item flex flex-col items-center text-indigo-600 w-1/4"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 20 20" fill="currentColor"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" /></svg><span class="text-xs font-bold">Home</span></a>
                <a id="nav-services" href="javascript:void(0);" onclick="navigateTo('services')" class="nav-item flex flex-col items-center text-gray-500 w-1/4"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" /></svg><span class="text-xs">Services</span></a>
                <a id="nav-notifications" href="javascript:void(0);" onclick="navigateTo('notifications')" class="nav-item flex flex-col items-center text-gray-500 w-1/4"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" /></svg><span class="text-xs">Notifications</span></a>
                <a id="nav-settings" href="javascript:void(0);" onclick="navigateTo('settings')" class="nav-item flex flex-col items-center text-gray-500 w-1/4"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0 3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg><span class="text-xs">Settings</span></a>
            </div>
        </nav>
    </div>

    <script>
        // --- Dark Mode Logic ---
        function applyDarkMode() {
            if (localStorage.getItem('theme') === 'dark') {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        }
        function toggleDarkMode() {
            document.documentElement.classList.toggle('dark');
            localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
        }
        applyDarkMode();

        // --- Page Content & Data ---
        const pageContents = {
            home: `
                <div class="page-content p-4 space-y-6">
                    <h2 class="text-2xl font-bold text-gray-800">Hello, Somchai!</h2>
                    <div class="relative"><input id="search-input" type="text" placeholder="Search news..." class="w-full pl-4 pr-10 py-2 border rounded-lg"></div>
                    <div class="flex space-x-2"><button data-filter="all" class="filter-button filter-button-active">All</button><button data-filter="scholarship" class="filter-button">Scholarship</button><button data-filter="activity" class="filter-button">Activity</button></div>
                    <div id="news-feed" class="space-y-4"></div>
                    <div id="no-results" class="text-center text-gray-500 hidden py-8">No results found.</div>
                </div>`,
            services: `
                <div class="page-content p-4">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">Services</h2>
                    <p>Student services will be listed here.</p>
                </div>`,
            notifications: `
                <div class="page-content p-4">
                    <div class="flex justify-between items-center"><h2 class="text-2xl font-bold text-gray-800">Notifications</h2><button class="text-sm text-indigo-600" onclick="markAllRead()">Mark all as read</button></div>
                    <div id="notification-list" class="space-y-3 mt-4"></div>
                </div>`,
            settings: `
                <div class="page-content p-4">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">Settings</h2>
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md divide-y dark:divide-gray-700">
                        <a href="javascript:void(0);" onclick="navigateTo('editProfile')" class="p-4 flex justify-between items-center"><span class="text-gray-800">Edit Profile</span><span>&gt;</span></a>
                        <label class="p-4 flex justify-between items-center cursor-pointer"><span class="text-gray-800">Dark Mode</span><input type="checkbox" onchange="toggleDarkMode()" id="dark-mode-toggle" ${localStorage.getItem('theme') === 'dark' ? 'checked' : ''}></label>
                    </div>
                </div>`,
            editProfile: `
                <div class="page-content p-4">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">Edit Profile</h2>
                     <div class="space-y-4">
                        <div><label class="text-sm font-medium text-gray-700">Full Name</label><input type="text" value="Somchai Jaidee" class="mt-1 block w-full px-3 py-2 border rounded-md"></div>
                        <button onclick="goBack()" class="w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg">Save</button>
                    </div>
                </div>`
        };

        const newsData = [
            { id: 1, title: 'Scholarship Announcement', desc: 'The Division of Student Affairs is now accepting applications...', tags: ['scholarship'] },
            { id: 2, title: 'UBU Games 2025', desc: 'Join the annual sports competition starting next month.', tags: ['activity'] }
        ];

        const notificationsData = [
            { id: 1, title: 'Library will be closed', read: false },
            { id: 2, title: 'New materials for SC101', read: false },
            { id: 3, title: 'Welcome to UBU Hub!', read: true }
        ];

        // --- Core Navigation & Rendering ---
        const mainContent = document.getElementById('main-content-container');
        const navItems = document.querySelectorAll('.nav-item');
        let pageStack = ['home'];

        function renderCurrentPage() {
            const pageName = pageStack[pageStack.length - 1];
            mainContent.innerHTML = pageContents[pageName] || `<div class="p-4"><h2 class="text-2xl font-bold">Page Not Found</h2></div>`;
            
            // Run page-specific logic after rendering
            if (pageName === 'home') renderHomePage();
            if (pageName === 'notifications') renderNotificationsPage();
            if (pageName === 'settings') { // Re-attach dark mode toggle logic
                 document.getElementById('dark-mode-toggle').checked = document.documentElement.classList.contains('dark');
            }

            updateNavHighlight();
            updateHeader();
        }

        function navigateTo(pageName) {
            const mainTabs = ['home', 'services', 'notifications', 'settings'];
            if (mainTabs.includes(pageName)) {
                pageStack = [pageName];
            } else {
                if (pageStack[pageStack.length - 1] !== pageName) pageStack.push(pageName);
            }
            renderCurrentPage();
        }

        function goBack() {
            if (pageStack.length > 1) {
                pageStack.pop();
                renderCurrentPage();
            }
        }

        function updateNavHighlight() {
            const currentMainPage = pageStack[0];
            navItems.forEach(item => {
                const span = item.querySelector('span');
                if (item.id === `nav-${currentMainPage}`) {
                    item.classList.add('text-indigo-600', 'font-bold');
                    item.classList.remove('text-gray-500');
                } else {
                    item.classList.remove('text-indigo-600', 'font-bold');
                    item.classList.add('text-gray-500');
                }
            });
        }

        function updateHeader() {
            document.getElementById('back-button').classList.toggle('hidden', pageStack.length <= 1);
            document.getElementById('header-title').classList.toggle('hidden', pageStack.length > 1);
        }

        // --- Page Specific Renderers & Logic ---
        function renderHomePage() {
            const feed = document.getElementById('news-feed');
            const searchInput = document.getElementById('search-input');
            const filterButtons = document.querySelectorAll('.filter-button');
            const noResults = document.getElementById('no-results');

            function displayNews(filter = 'all', search = '') {
                const filteredNews = newsData.filter(item => 
                    (filter === 'all' || item.tags.includes(filter)) &&
                    (item.title.toLowerCase().includes(search) || item.desc.toLowerCase().includes(search))
                );

                if (filteredNews.length > 0) {
                    feed.innerHTML = filteredNews.map(item => `
                        <a href="javascript:void(0);" class="news-item block bg-white dark:bg-gray-800 p-4 rounded-xl shadow-md">
                            <h4 class="font-bold text-gray-900">${item.title}</h4>
                            <p class="text-sm text-gray-600 mt-1">${item.desc}</p>
                        </a>`).join('');
                    noResults.classList.add('hidden');
                } else {
                    feed.innerHTML = '';
                    noResults.classList.remove('hidden');
                }
            }

            filterButtons.forEach(button => {
                button.addEventListener('click', () => {
                    filterButtons.forEach(btn => btn.classList.remove('filter-button-active'));
                    button.classList.add('filter-button-active');
                    displayNews(button.dataset.filter, searchInput.value.toLowerCase());
                });
            });

            searchInput.addEventListener('input', () => {
                const activeFilter = document.querySelector('.filter-button-active').dataset.filter;
                displayNews(activeFilter, searchInput.value.toLowerCase());
            });

            displayNews(); // Initial display
        }
        
        function renderNotificationsPage() {
            const list = document.getElementById('notification-list');
            list.innerHTML = notificationsData.map(n => `
                <div class="notification-item p-3 rounded-lg ${n.read ? 'bg-gray-100 dark:bg-gray-700' : 'bg-white dark:bg-gray-800 shadow-sm'}">
                    <p class="font-semibold ${n.read ? 'text-gray-500' : 'text-gray-800'}">${n.title}</p>
                </div>`).join('');
        }

        function markAllRead() {
            notificationsData.forEach(n => n.read = true);
            renderNotificationsPage();
        }

        // --- Initial Load ---
        document.addEventListener('DOMContentLoaded', renderCurrentPage);
    </script>
</body>
</html>

